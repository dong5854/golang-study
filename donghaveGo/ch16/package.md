# 패키지

패키지란 Go 언어에서 코드를 묶는 가장 큰 단위로 다른 언어에서는 네임스페이스라는 키워드를 사용해서 코드 영역을 분리하기도 하지만, Go 언어에서는 다른 언어와 같은 네임스페이스를 지원하지 않고 패키지를 사용한다.

함수로 코드 블록을, 구조체로 데이터를, 패키지로 함수와 구조체와 그 외 코드를 묶는다.

## main 패키지
main 패키지는 특별한 패키지로 프로그램 시작점을 포함한 패키지이다. 프로그램 시작점은 main()함수를 의미하며 프로그램이 실행되면 (대부분) 운영체제는 프로그램을 메모리로 올린다. 이것을 로드(Load)라고 한다.

## 겹치는 패키지 별칭 주기
패키지 명이 겹치는 경우에는 별칭을 줘서 구분할 수 있다.
``` go
import(
    "text/template" // template 패키지
    htemplate "html/template" //별칭 htemplate
)
```

## 사용하지 않는 패키지 포함하기

패키지를 임포트하고 사용하지 않으면 에럭가 발생한다. 패키지를 직접 사용하지 않지만 부가효과를 얻고자 임포트하는 경우에는 밑줄을 패키지명 앞에 붙여주면 된다. 여기서 부가효과란 패키지가 초기화되면서 실행되는 코드에 따른 효과를 말한다.

``` go
import(
    "database/sql"
    _ "github.com/mattn/go-sqlite3"
)
```

## 패키지 설치
import로 패키지를 포함시키면 go build를 통해 빌드할 때 해당 패키지를 찾아 포함한 다음 실행 파일을 생성하는데 Go는 이 패키지를 어떻게 찾을까?
1. Go언어의 기본 패키지는 Go의 설치 경로에서 찾는다.
2. 깃허브와 같은 외부 저장소에 저장된 채키지의 경우 외부 저장소에서 다운받아서 GOPATH/pkg 폴더에 설치한다. 이때 Go 모듈에 정의된 패키지 버전에 맞게 다운로드한다.
3. 현재 모듈 아래 위치한 패키지인지 검사한다. 현재 모듈 아래 위치한 패키지는 현재 폴더 아래 있는 패키지를 찾는다.

## Go 모듈
Go 모듈은 Go 패키지들을 모아놓은 Go 프로젝트 단위이다. Go 1.16 버전부터 Go 모듈 사용이 기본이 됐다. 이전까지 Go 모듈을 만들지 않는 Go 코드는 모두 GOPATH/src 폴더 아래 있어야 했지만 Go 모듈이 기본이 되면서 모든 Go 코드는 Go 모듈 아래 있어야한다.

`go build`를 하려면 반드시 Go 모듈 루트 폴더에 go.mod 파일이 있어야한다. 이 파일에는 모듈 이름과 Go 버전, 필요한 외부 패키지 등이 면시되어있다. Go 언어에서는 go build를 통해 실행 파일을 만들 때 `go.mod`와 외부 저장소 패키지 버전 정보를 담고 있는 `go.sum` 파일을 통해 외부 패키지와 모듈 내 패키지를 합쳐 실행 파일을 만든다.

Go 모듈은 `go mod init`명령을 통해 만들 수 있다.
```  bash
go mod init [패키지명]
```
위 명령을 실행하면 go.mod 파일이 생성된다.

## go mod tidy

`go mod tidy`명령은 Go 모듈에 필요한 패키지를 찾아서 다운로드해주고 필요한 패키지 정보를 `go.mod` 파일과 `go.sum` 파일에 적어준다. 또한 사용하지 않는 의존성도 제거해준다.

## 다운 받은 외부 패키지들 저장 위치
다운받은 외부 패키지들은 GOPATH/pkg/mod 폴더에 버전별로 저장되어 있다. 그래서 이미 한 번 다운 받은 패키지들은 다른 모듈에서 사용해도 같은 버전이면 다시 다운로드 하지 않고 사용하게 된다. 그리고 go.mod와 go.sum에 필요한 패키지의 버전 정보가 기입되어서 항상 같은 버전의 패키지가 사용되므로 버전 업데이트에 다른 문제가 발생하지 않는다.
GOPATH는 맥, 리눅스에서는 ~/go, 윈도우에서는 c:\Users\본인계정\go 이다.

## 패키지명
Go 에서 패키지명은 쉽고 간단하게 모든 문자를 소문자로 할것을 권장한다.
패키지 외부로 공개할 변수, 상수, 타입, 함수, 메서드는 첫 글자가 대문자여야한다.

## 패키지 초기화, init()

패키지를 임포트하면 컴파일러는 패키지 내 전역 변수를 초기화한다. 그런 다음 패키지에 init() 함수가 있다면 호출해 패키지를 초기화한다.이떄 패키지 초기화는 패키지가 여러면 import 되더라도 한번만 수행된다.
이런 패키지의 초기화만 원할 경우 위에서 본 대로 _ 를 앞에 넣어 임포트한다.
init() 함수는 반드시 입력 매개변수가 없고 반환값도 없는 함수여야한다.